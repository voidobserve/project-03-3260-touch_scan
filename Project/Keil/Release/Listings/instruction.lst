C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE INSTRUCTION
OBJECT MODULE PLACED IN .\Release\Objects\instruction.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\User\instruction.c LARGE OPTIMIZE(8,SIZE) BROWSE INTVECTOR(0X000C)
                    - INCDIR(..\..\Libraries\Include;..\..\User;..\..\User\lib;..\..\Hardware) INTERVAL(3) DEBUG OBJECTEXTEND PRINT(.\Release
                    -\Listings\instruction.lst) OBJECT(.\Release\Objects\instruction.obj)

line level    source

   1          #include "instruction.h"
   2          
   3          #include <string.h>
   4          
   5          // ç”¨bitå®šä¹‰ï¼Œæ¥èŠ‚çœç©ºé—´
   6          volatile bit flag_get_all_status = 0;    // è·å–æ‰€æœ‰åŠŸèƒ½çš„çŠ¶æ€
   7          volatile bit flag_get_gear = 0;          // è·å–æŒ¡ä½çŠ¶æ€ / å¾—åˆ°äº†æŒ¡ä½çš„çŠ¶æ€
   8          volatile bit flag_get_battery = 0;       // è·å–ç”µæ± çŠ¶æ€ / å¾—åˆ°äº†ç”µæ± çš„çŠ¶æ€ï¼ˆç”µæ± ç”µé‡ï¼
             -Œå•ä½ï¼šç™¾åˆ†æ¯”ï¼‰
   9          volatile bit flag_get_brake = 0;         // è·å–åˆ¹è½¦çŠ¶æ€ / å¾—åˆ°äº†åˆ¹è½¦çš„çŠ¶æ€
  10          volatile bit flag_get_left_turn = 0;     // è·å–å·¦è½¬å‘ç¯çš„çŠ¶æ€ / å¾—åˆ°äº†å·¦è½¬å‘ç¯çš„çŠ¶æ€
  11          volatile bit flag_get_right_turn = 0;    // è·å–å³è½¬å‘ç¯çš„çŠ¶æ€ / å¾—åˆ°äº†å³è½¬å‘ç¯çš„çŠ¶æ€
  12          volatile bit flag_get_high_beam = 0;     // è·å–è¿œå…‰ç¯çš„çŠ¶æ€ / å¾—åˆ°äº†è¿œå…‰ç¯çš„çŠ¶æ€
  13          volatile bit flag_get_engine_speed = 0;  // è·å–å‘åŠ¨æœºçš„è½¬é€Ÿ / å¾—åˆ°äº†å‘åŠ¨æœºçš„è½¬é€Ÿ
  14          volatile bit flag_get_speed = 0;         // è·å–æ—¶é€Ÿ / å¾—åˆ°äº†æ—¶é€Ÿ
  15          volatile bit flag_get_fuel = 0;          // è·å–æ²¹é‡ / å¾—åˆ°äº†æ²¹é‡ï¼ˆå•ä½ï¼šç™¾åˆ†æ¯”ï¼‰
  16          // volatile bit flag_get_temp_of_water = 0; // è·å–æ°´æ¸© / å¾—åˆ°äº†æ°´æ¸© 
  17          
  18          volatile bit flag_get_total_mileage = 0;     // è·å–å¤§è®¡é‡Œç¨‹ / å¾—åˆ°äº†å¤§è®¡é‡Œç¨‹
  19          volatile bit flag_get_sub_total_mileage = 0; // è·å–å°è®¡é‡Œç¨‹ / å¾—åˆ°äº†å°è®¡é‡Œç¨‹
  20          
  21          // volatile bit flag_get_touch_key_status = 0; // è·å–è§¦æ‘¸æŒ‰é”®çš„çŠ¶æ€
  22          volatile bit flag_alter_date = 0;           // ä¿®æ”¹æ—¥æœŸ
  23          volatile bit flag_alter_time = 0;           // ä¿®æ”¹æ—¶é—´
  24          
  25          volatile bit flag_get_voltage_of_battery = 0;    // è·å–ç”µæ± ç”µå‹
  26          volatile bit flag_set_temp_of_water_warning = 0; // è®¾ç½®æ°´æ¸©æŠ¥è­¦
  27          
  28          volatile bit flag_clear_total_mileage = 0;     // æ¸…é™¤å¤§è®¡é‡Œç¨‹
  29          volatile bit flag_clear_sub_total_mileage = 0; // æ¸…é™¤å°è®¡é‡Œç¨‹
  30          
  31          // // å­˜æ”¾æ¥æ”¶åˆ°çš„è®¾ç½®æ°´æ¸©æŠ¥è­¦çš„æŒ‡ä»¤ä¸­ï¼Œå¯¹åº”çš„æ“ä½œï¼Œé»˜è®¤ä¸ºæ— æ“ä½œ
  32          // volatile u8 operation_set_temp_of_water_warning = OPERATION_SET_TEMP_OF_WATER_WARNING_NONE;
  33          
  34          // æ£€æŸ¥æ¥æ”¶æ˜¯å¦æ­£ç¡®çš„å‡½æ•°ï¼Œå¦‚æœæ¥æ”¶æ­£ç¡®ï¼Œ
  35          // æ ¹æ®æ¥æ”¶åˆ°çš„æ•°æ®ä¸­çš„æŒ‡ä»¤ï¼Œç»™å¯¹åº”çš„æŒ‡ä»¤çš„æ ‡å¿—ä½ç½®ä¸€
  36          void instruction_scan(void)
  37          {
  38   1          u8 i = 0; // æ³¨æ„è¦å¤§äºç­‰äºç¼“å†²åŒºèƒ½å­˜æ”¾çš„æŒ‡ä»¤æ•°ç›®
  39   1      
  40   1          for (i = 0; i < (UART0_RXBUF_LEN) / (FRAME_MAX_LEN); i++)
  41   1          {
  42   2              if (flagbuf_valid_instruction[i]) // å¦‚æœå¯¹åº”çš„ä½ç½®æœ‰åˆæ³•çš„æ•°æ®å¸§
  43   2              {
  44   3                  // æ ¹æ®æ¥æ”¶åˆ°æ•°æ®ä¸­çš„æŒ‡ä»¤ï¼Œç»™å¯¹åº”çš„æŒ‡ä»¤çš„æ ‡å¿—ä½ç½®ä¸€
  45   3                  // if (4 == uart0_recv_buf[i][1]) // å¦‚æœæ˜¯å››ä½é•¿åº¦çš„æŒ‡ä»¤
  46   3                  {
  47   4                      switch (uart0_recv_buf[i][2]) // æ ¹æ®ä¸åŒçš„æŒ‡ä»¤æ¥ç»™å¯¹åº”çš„æ ‡å¿—ä½ç½®ä¸€
  48   4                      {
  49   5                      case INSTRUCTION_GET_ALL_STATUS: // è·å–æ‰€æœ‰åŠŸèƒ½çš„çŠ¶æ€
  50   5                          flag_get_all_status = 1;
  51   5                          break;
  52   5      
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 2   

  53   5      #if 0  // ä¸å¯¹MP5å‘é€çš„è¿™äº›æŒ‡ä»¤è¿›è¡Œå¤„ç†
                     // case INSTRUCTION_GET_GEAR: // è·å–æŒ¡ä½çš„çŠ¶æ€
                     //     flag_get_gear = 1;
                     //     break;
              
                              // case INSTRUCTION_GET_BATTERY: // è·å–ç”µæ± ç”µé‡çš„çŠ¶æ€
                              //     flag_get_battery = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_BARKE: // è·å–åˆ¹è½¦çš„çŠ¶æ€
                              //     flag_get_brake = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_LEFT_TURN: // è·å–å·¦è½¬å‘ç¯çš„çŠ¶æ€
                              //     flag_get_left_turn = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_RIGHT_TURN: // è·å–å³è½¬å‘ç¯çš„çŠ¶æ€
                              //     flag_get_right_turn = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_HIGH_BEAM: // è·å–è¿œå…‰ç¯çš„çŠ¶æ€
                              //     flag_get_high_beam = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_ENGINE_SPEED: // è·å–å‘åŠ¨æœºè½¬é€Ÿ
                              //     flag_get_engine_speed = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_SPEED: // è·å–æ—¶é€Ÿ
                              //     flag_get_speed = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_FUEL: // è·å–æ²¹é‡
                              //     flag_get_fuel = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_TEMP_OF_WATER: // è·å–æ°´æ¸©
                              //     flag_get_temp_of_water = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_TOTAL_MILEAGE: // è·å–å¤§è®¡é‡Œç¨‹
                              //     flag_get_total_mileage = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_SUBTOTAL_MILEAGE: // è·å–å°è®¡é‡Œç¨‹
                              //     flag_get_sub_total_mileage = 1;
                              //     break;
              
                              // case INSTRUCTION_GET_TOUCH_KEY_STATUS: // è·å–è§¦æ‘¸æŒ‰é”®çš„çŠ¶æ€
                              //     flag_get_touch_key_status = 1;
                              //     break;
              
                     
              
                            
              
                              // case INSTRUCTION_GET_BATTERY_VAL: // è·å–ç”µæ± ç”µå‹
                              //     flag_get_voltage_of_battery = 1;
                              //     break;
              
                              // case INSTRUCTION_SET_TEMP_OF_WATER_WARNING: // è®¾ç½®æ°´æ¸©æŠ¥è­¦
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 3   

                              //     flag_set_temp_of_water_warning = 1;
              
                              //     break;
              #endif // ä¸å¯¹MP5å‘é€çš„è¿™äº›æŒ‡ä»¤è¿›è¡Œå¤„ç†
 119   5      
 120   5                      case INSTRUCTION_ALTER_DATE: // ä¿®æ”¹æ—¥æœŸ
 121   5                          flag_alter_date = 1;
 122   5                          // fun_info.date = ((u32)uart0_recv_buf[i][3] << 24) + /* å¹´ */
 123   5                          //                 ((u32)uart0_recv_buf[i][4] << 16) +
 124   5                          //                 ((u32)uart0_recv_buf[i][5] << 8) + /* æœˆ */
 125   5                          //                 ((u32)uart0_recv_buf[i][6] << 0);  /* æ—¥ */
 126   5                          fun_info.save_info.year = ((u16)uart0_recv_buf[i][3] << 8) +
*** ERROR C200 IN LINE 126 OF ..\..\User\instruction.c: left side of '.' requires struct/union
 127   5                                                    (u16)uart0_recv_buf[i][4];
 128   5                          fun_info.save_info.month = uart0_recv_buf[i][5];
 129   5                          fun_info.save_info.day = uart0_recv_buf[i][6];
 130   5      
 131   5                          break;
 132   5      
 133   5                      case INSTRUCTION_ALTER_TIME: // ä¿®æ”¹æ—¶é—´
 134   5                          flag_alter_time = 1;
 135   5                          // ä¾‹ï¼šA5 07 2F 0D 37 18 07
 136   5                          fun_info.save_info.time_hour = uart0_recv_buf[i][3];
 137   5                          fun_info.save_info.time_min = uart0_recv_buf[i][4];
 138   5                          fun_info.save_info.time_sec = uart0_recv_buf[i][5];
 139   5                          break;
 140   5      
 141   5                      case INSTRUCTION_CLEAR_TOTAL_MILEAGE: // æ¸…é™¤å¤§è®¡é‡Œç¨‹
 142   5                          flag_clear_total_mileage = 1;
 143   5                          break;
 144   5      
 145   5                      case INSTRUCTION_CLEAR_SUBTOTAL_MILEAGE: // æ¸…é™¤å°è®¡é‡Œç¨‹
 146   5                          flag_clear_sub_total_mileage = 1;
 147   5                          break;
 148   5                      }
 149   4      
 150   4                      if (recv_frame_cnt > 0) //
 151   4                      {
 152   5                          recv_frame_cnt--; // ä»ä¸²å£æ¥æ”¶çš„æ•°æ®å¸§æ•°ç›®å‡ä¸€ï¼Œè¡¨ç¤ºæŒ‡ä»¤å·²ç»ä»ç¼
             -“å†²åŒºå–å‡º
 153   5                      }
 154   4      
 155   4                      flagbuf_valid_instruction[i] = 0; // æ¸…ç©ºç¼“å†²åŒºå¯¹åº”çš„å…ƒç´ ï¼Œè¡¨ç¤ºè¯¥ä¸‹æ ‡çš„æŒ
             -‡ä»¤å·²ç»å¤„ç†
 156   4                      uart0_recv_len[i] = 0;
 157   4                      recved_flagbuf[i] = 0;
 158   4                      memset(uart0_recv_buf[i], 0, FRAME_MAX_LEN); // æ¸…ç©ºç¼“å†²åŒºå¯¹åº”çš„å…ƒç´ 
 159   4                  } // if (4 == uart0_recv_buf[i][1])
 160   3              }
 161   2          }
 162   1      }
 163          
 164          void instruction_handle(void)
 165          {
 166   1          if (flag_get_all_status)
 167   1          {
 168   2              // å¦‚æœè¦è·å–æ‰€æœ‰åŠŸèƒ½çš„çŠ¶æ€
 169   2              u32 temp_val = 0;        // ä¸´æ—¶å˜é‡(åœ¨å‘é€æ—¥æœŸå’Œæ—¶é—´ä½¿ç”¨åˆ°)
 170   2              flag_get_all_status = 0; // æ¸…é™¤æ ‡å¿—ä½
 171   2      
 172   2      #if USE_MY_DEBUG
 173   2              printf(" flag_get_all_status\n");
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 4   

 174   2      #endif
 175   2      
 176   2              // è·å–æ‰€æœ‰åŠŸèƒ½çš„çŠ¶æ€ï¼Œéœ€è¦æŠŠè¿™äº›åŠŸèƒ½å¯¹åº”çš„çŠ¶æ€éƒ½å‘é€å‡ºå»
 177   2              send_data(SEND_GEAR, fun_info.gear);                                         // 1. å‘é€å½“å‰æŒ¡
             -ä½çš„çŠ¶æ€
 178   2              send_data(SEND_BATTERY, fun_info.battery);                                   // 2. å‘é€ç”µæ± ç”µ
             -é‡
 179   2              send_data(SEND_BARKE, fun_info.brake);                                       // 3. å‘é€å½“å‰åˆ¹
             -è½¦çš„çŠ¶æ€
 180   2              send_data(SEND_LEFT_TURN, fun_info.left_turn);                               // 4. å‘é€å½“å‰å·¦
             -è½¬å‘ç¯çš„çŠ¶æ€
 181   2              send_data(SEND_RIGHT_TURN, fun_info.right_turn);                             // 5. å‘é€å½“å‰å³
             -è½¬å‘ç¯çš„çŠ¶æ€
 182   2              send_data(SEND_HIGH_BEAM, fun_info.high_beam);                               // 6. å‘é€å½“å‰è¿œ
             -å…‰ç¯çš„çŠ¶æ€
 183   2              send_data(SEND_ENGINE_SPEED, fun_info.engine_speeed);                        // 7. å‘é€å‘åŠ¨æœº
             -è½¬é€Ÿ
 184   2              send_data(SEND_SPEED, fun_info.speed);                                       // 8. å‘é€å½“å‰é‡‡
             -é›†åˆ°çš„è½¦é€Ÿï¼ˆæ—¶é€Ÿï¼‰
 185   2              send_data(SEND_FUEL, fun_info.fuel);                                         // 9. å‘é€å½“å‰æ²¹
             -é‡(å•ä½ï¼šç™¾åˆ†æ¯”)
 186   2              send_data(SEND_WATER_TEMP, fun_info.temp_of_water);                          // 10. å‘é€å½“å‰é‡
             -‡é›†çš„æ°´æ¸©
 187   2      #ifdef USE_INTERNATIONAL                                                             // å…¬åˆ¶å•ä½
                      send_data(SEND_TOTAL_MILEAGE, fun_info.save_info.total_mileage / 100);       // 11. å‘é€å¤§è®¡é‡
             -Œç¨‹ï¼ˆåªå‘é€ç™¾ç±³åŠä»¥ä¸Šçš„æ•°æ®ï¼‰
                      send_data(SEND_SUBTOTAL_MILEAGE, fun_info.save_info.subtotal_mileage / 100); // 12. å‘é€å°è®¡é‡
             -Œç¨‹(åªå‘é€ç™¾ç±³åŠä»¥ä¸Šçš„æ•°æ®)
              #endif                                                                               // USE_INTERNATIONAL 
             -å…¬åˆ¶å•ä½
 191   2      
 192   2      #ifdef USE_IMPERIAL // è‹±åˆ¶å•ä½
              
                      send_data(SEND_TOTAL_MILEAGE, fun_info.save_info.total_mileage / 161);       // 11. å‘é€å¤§è®¡é‡
             -Œç¨‹ï¼ˆåªå‘é€0.1è‹±é‡ŒåŠä»¥ä¸Šçš„æ•°æ®ï¼‰
                      send_data(SEND_SUBTOTAL_MILEAGE, fun_info.save_info.subtotal_mileage / 161); // 12. å‘é€å°è®¡é‡
             -Œç¨‹(åªå‘é€0.1è‹±é‡ŒåŠä»¥ä¸Šçš„æ•°æ®)
              
              #endif // USE_IMPERIAL è‹±åˆ¶å•ä½
 198   2      
 199   2              // 13. å‘é€è§¦æ‘¸æŒ‰é”®çš„çŠ¶æ€
 200   2              // send_data(SEND_TOUCH_KEY_STATUS, fun_info.touch_key_val);
 201   2              // 14. å‘é€å½“å‰æ—¥æœŸ
 202   2              temp_val = ((u32)fun_info.save_info.year << 16) |
 203   2                         ((u32)fun_info.save_info.month << 8) |
 204   2                         fun_info.save_info.day;
 205   2              send_data(SEND_DATE, temp_val);
 206   2              // 15. å‘é€å½“å‰æ—¶é—´
 207   2              temp_val = ((u32)fun_info.save_info.time_hour << 16) |
 208   2                         ((u32)fun_info.save_info.time_min << 8) |
 209   2                         fun_info.save_info.time_sec;
 210   2              send_data(SEND_TIME, temp_val);
 211   2              // 16. å‘é€å½“å‰çš„ç”µæ± ç”µå‹
 212   2              send_data(SEND_VOLTAGE_OF_BATTERY, fun_info.voltage_of_battery);
 213   2              // 17. å‘é€å½“å‰çš„æ°´æ¸©æŠ¥è­¦çŠ¶æ€
 214   2              send_data(SEND_TEMP_OF_WATER_ALERT, fun_info.flag_is_in_water_temp_warning);
 215   2          }
 216   1      
 217   1          if (flag_get_gear)
 218   1          {
 219   2              // å¦‚æœè¦è·å–æŒ¡ä½çš„çŠ¶æ€
 220   2              flag_get_gear = 0; //
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 5   

 221   2      
 222   2      #if USE_MY_DEBUG
 223   2              printf(" flag_get_gear\n");
 224   2      #endif
 225   2      
 226   2              send_data(SEND_GEAR, fun_info.gear); // å‘é€å½“å‰æŒ¡ä½çš„çŠ¶æ€
 227   2          }
 228   1      
 229   1          if (flag_get_battery)
 230   1          {
 231   2              // å¦‚æœè¦è·å–ç”µæ± ç”µé‡çš„çŠ¶æ€
 232   2              flag_get_battery = 0;
 233   2      #if USE_MY_DEBUG
 234   2              printf(" flag_get_battery\n");
 235   2      #endif
 236   2      
 237   2              send_data(SEND_BATTERY, fun_info.battery); // å‘é€ç”µæ± ç”µé‡
 238   2          }
 239   1      
 240   1          if (flag_get_brake)
 241   1          {
 242   2              // å¦‚æœè¦è·å–è·å–åˆ¹è½¦çš„çŠ¶æ€
 243   2              flag_get_brake = 0;
 244   2      
 245   2      #if USE_MY_DEBUG
 246   2              printf(" flag_get_brake\n");
 247   2      #endif
 248   2      
 249   2              send_data(SEND_BARKE, fun_info.brake); // å‘é€å½“å‰åˆ¹è½¦çš„çŠ¶æ€
 250   2          }
 251   1      
 252   1          if (flag_get_left_turn)
 253   1          {
 254   2              // å¦‚æœè¦è·å–å·¦è½¬å‘ç¯çš„çŠ¶æ€
 255   2              flag_get_left_turn = 0;
 256   2      
 257   2      #if USE_MY_DEBUG
 258   2              printf(" flag_get_left_turn\n");
 259   2      #endif
 260   2      
 261   2              send_data(SEND_LEFT_TURN, fun_info.left_turn); // å‘é€å½“å‰å·¦è½¬å‘ç¯çš„çŠ¶æ€
 262   2          }
 263   1      
 264   1          if (flag_get_right_turn)
 265   1          {
 266   2              // å¦‚æœè¦è·å–å³è½¬å‘ç¯çš„çŠ¶æ€
 267   2              flag_get_right_turn = 0;
 268   2      #if USE_MY_DEBUG
 269   2              printf(" flag_get_right_turn\n");
 270   2      #endif
 271   2              send_data(SEND_RIGHT_TURN, fun_info.right_turn); // å‘é€å½“å‰å³è½¬å‘ç¯çš„çŠ¶æ€
 272   2          }
 273   1      
 274   1          if (flag_get_high_beam)
 275   1          {
 276   2              // å¦‚æœè¦è·å–è¿œå…‰ç¯çš„çŠ¶æ€
 277   2              flag_get_high_beam = 0;
 278   2      #if USE_MY_DEBUG
 279   2              printf(" flag_get_high_beam\n");
 280   2      #endif
 281   2              send_data(SEND_HIGH_BEAM, fun_info.high_beam); // å‘é€å½“å‰è¿œå…‰ç¯çš„çŠ¶æ€
 282   2          }
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 6   

 283   1      
 284   1          if (flag_get_engine_speed)
 285   1          {
 286   2              // å¦‚æœè¦è·å–å‘åŠ¨æœºçš„è½¬é€Ÿ
 287   2              flag_get_engine_speed = 0;
 288   2      #if USE_MY_DEBUG
 289   2              printf(" flag_get_engine_speed \n");
 290   2              printf(" cur engine speed %u rpm ", (u16)fun_info.engine_speeed);
 291   2      #endif
 292   2              send_data(SEND_ENGINE_SPEED, fun_info.engine_speeed);
 293   2          }
 294   1      
 295   1          if (flag_get_speed)
 296   1          {
 297   2              // å¦‚æœè¦è·å–æ—¶é€Ÿ
 298   2              flag_get_speed = 0;
 299   2      #if USE_MY_DEBUG
 300   2              printf(" flag_get_speed \n");
 301   2      #endif
 302   2      
 303   2      #ifdef USE_INTERNATIONAL // ä½¿ç”¨å…¬åˆ¶å•ä½
              
                      send_data(SEND_SPEED, fun_info.speed); // å‘é€å½“å‰é‡‡é›†åˆ°çš„è½¦é€Ÿï¼ˆæ—¶é€Ÿï¼‰
              
              #endif // USE_INTERNATIONAL ä½¿ç”¨å…¬åˆ¶å•ä½
 308   2      
 309   2      #ifdef USE_IMPERIAL // ä½¿ç”¨è‹±åˆ¶å•ä½
              
                      send_data(SEND_SPEED, fun_info.speed * 621 / 1000);
              
              #endif
 314   2          }
 315   1      
 316   1          if (flag_get_fuel)
 317   1          {
 318   2              // å¦‚æœè¦è·å–æ²¹é‡
 319   2              flag_get_fuel = 0;
 320   2      
 321   2      #if USE_MY_DEBUG
 322   2              printf(" flag_get_fuel \n");
 323   2      #endif
 324   2      
 325   2              send_data(SEND_FUEL, fun_info.fuel);
 326   2          }
 327   1      
 328   1      // ä¸ç”¨å‘é€æ°´æ¸©ï¼Œæ”¹ä¸ºå‘é€æ°´æ¸©æŠ¥è­¦
 329   1      //     if (flag_get_temp_of_water)
 330   1      //     {
 331   1      //         // å¦‚æœè¦è·å–æ°´æ¸©
 332   1      //         flag_get_temp_of_water = 0;
 333   1      // #if USE_MY_DEBUG
 334   1      //         printf(" flag_get_temp_of_water \n");
 335   1      // #endif
 336   1      //         send_data(SEND_WATER_TEMP, fun_info.temp_of_water);
 337   1      //     }
 338   1      
 339   1          if (flag_get_total_mileage)
 340   1          {
 341   2              // å¦‚æœè¦è·å–å¤§è®¡é‡Œç¨‹ / å¾—åˆ°äº†å¤§è®¡é‡Œç¨‹æ–°çš„æ•°æ®
 342   2              flag_get_total_mileage = 0;
 343   2      #if USE_MY_DEBUG
 344   2              printf(" flag_get_total_mileage \n");
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 7   

 345   2              printf(" cur total mileage %lu /0.1km \n", (u32)fun_info.save_info.total_mileage);
 346   2      #endif
 347   2      
 348   2      #ifdef USE_INTERNATIONAL // å…¬åˆ¶å•ä½
              
                      // åªå‘é€ç™¾ç±³åŠä»¥ä¸Šçš„æ•°æ®
                      send_data(SEND_TOTAL_MILEAGE, fun_info.save_info.total_mileage / 100);
              
              #endif // USE_INTERNATIONAL å…¬åˆ¶å•ä½
 354   2      
 355   2      #ifdef USE_IMPERIAL // è‹±åˆ¶å•ä½
              
              #if USE_MY_DEBUG
                      printf("total mileage: %lu * 0.1 mile", fun_info.save_info.total_mileage / 161);
              #endif // USE_MY_DEBUG
              
                      // åªå‘é€0.1è‹±é‡ŒåŠä»¥ä¸Šçš„æ•°æ®
                      send_data(SEND_TOTAL_MILEAGE, fun_info.save_info.total_mileage / 161);
              
              #endif // USE_IMPERIAL è‹±åˆ¶å•ä½
 365   2          }
 366   1      
 367   1          if (flag_get_sub_total_mileage)
 368   1          {
 369   2              // å¦‚æœè¦è·å–å°è®¡é‡Œç¨‹ / å¾—åˆ°äº†å°è®¡é‡Œç¨‹æ–°çš„æ•°æ®
 370   2              flag_get_sub_total_mileage = 0;
 371   2      #if USE_MY_DEBUG
 372   2              printf(" flag_get_sub_total_mileage \n");
 373   2              printf(" cur subtotal mileage %lu /0.1km \n", (u32)fun_info.save_info.subtotal_mileage);
 374   2      #endif // USE_MY_DEBUG
 375   2      
 376   2      #ifdef USE_INTERNATIONAL // å…¬åˆ¶å•ä½
              
                      // åªå‘é€ç™¾ç±³åŠä»¥ä¸Šçš„æ•°æ®
                      send_data(SEND_SUBTOTAL_MILEAGE, fun_info.save_info.subtotal_mileage / 100);
              #endif // USE_INTERNATIONAL å…¬åˆ¶å•ä½
 381   2      
 382   2      #ifdef USE_IMPERIAL // è‹±åˆ¶å•ä½
              
              #if USE_MY_DEBUG
                      printf("sub total mileage: %lu mile", fun_info.save_info.subtotal_mileage / 161);
              #endif // USE_MY_DEBUG
                     // åªå‘é€0.1è‹±é‡ŒåŠä»¥ä¸Šçš„æ•°æ®
                     // å˜é‡ä¸­å­˜æ”¾çš„æ˜¯ä»¥mä¸ºå•ä½çš„æ•°æ®ï¼Œéœ€è¦åšè½¬æ¢å†å‘é€
                      send_data(SEND_SUBTOTAL_MILEAGE, fun_info.save_info.subtotal_mileage / 161);
              
              #endif // USE_IMPERIAL è‹±åˆ¶å•ä½
 392   2          }
 393   1      
 394   1      //     if (flag_get_touch_key_status)
 395   1      //     {
 396   1      //         // å¦‚æœè¦è·å–è§¦æ‘¸æŒ‰é”®çš„çŠ¶æ€ / å¾—åˆ°äº†è§¦æ‘¸æŒ‰é”®çš„çŠ¶æ€
 397   1      //         flag_get_touch_key_status = 0;
 398   1      // #if USE_MY_DEBUG
 399   1      //         printf(" flag_get_touch_key_status \n");
 400   1      // #endif
 401   1      //         send_data(SEND_TOUCH_KEY_STATUS, fun_info.touch_key_val);
 402   1      //     }
 403   1      
 404   1          if (flag_alter_date)
 405   1          {
 406   2              // å¦‚æœè¦ä¿®æ”¹æ—¥æœŸ
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 8   

 407   2              flag_alter_date = 0;
 408   2      #if USE_MY_DEBUG
 409   2              printf(" flag_alter_date \n");
 410   2              printf("year %d month %d day %d \n", (u16)fun_info.save_info.year, (u16)fun_info.save_info.month, 
             -(u16)fun_info.save_info.day);
 411   2      #endif
 412   2      
 413   2              fun_info_save(); // å°†æ—¥æœŸä¿¡æ¯å†™å›flash
 414   2          }
 415   1      
 416   1          if (flag_alter_time)
 417   1          {
 418   2              // å¦‚æœè¦ä¿®æ”¹æ—¶é—´
 419   2              flag_alter_time = 0;
 420   2      
 421   2      #if USE_MY_DEBUG
 422   2              printf(" flag_alter_time \n");
 423   2              printf("hour %d min %d sec %d \n", (u16)fun_info.save_info.time_hour, (u16)fun_info.save_info.time
             -_min, (u16)fun_info.save_info.time_sec);
 424   2      #endif
 425   2      
 426   2              fun_info_save(); // å°†æ—¶é—´ä¿¡æ¯å†™å›flash
 427   2          }
 428   1      
 429   1          if (flag_get_voltage_of_battery)
 430   1          {
 431   2              // å¦‚æœè¦è·å–ç”µæ± ç”µå‹
 432   2              flag_get_voltage_of_battery = 0;
 433   2      #if USE_MY_DEBUG
 434   2              printf(" flag_get_voltage_of_battery \n");
 435   2              printf(" cur voltage of battery %u \n", (u16)fun_info.voltage_of_battery);
 436   2      #endif
 437   2              send_data(SEND_VOLTAGE_OF_BATTERY, fun_info.voltage_of_battery);
 438   2          }
 439   1      
 440   1          if (flag_set_temp_of_water_warning)
 441   1          {
 442   2              // å¦‚æœè¦è®¾ç½®æ°´æ¸©æŠ¥è­¦
 443   2              flag_set_temp_of_water_warning = 0;
 444   2      #if USE_MY_DEBUG
 445   2              printf(" flag_set_temp_of_water_warning \n");
 446   2      #endif
 447   2              //  å‘é€å½“å‰æ°´æ¸©æŠ¥è­¦çš„çŠ¶æ€
 448   2              send_data(SEND_TEMP_OF_WATER_ALERT, fun_info.flag_is_in_water_temp_warning);
 449   2          }
 450   1      
 451   1          if (flag_clear_total_mileage)
 452   1          {
 453   2              // å¦‚æœè¦æ¸…é™¤å¤§è®¡é‡Œç¨‹
 454   2              flag_clear_total_mileage = 0;
 455   2              fun_info.save_info.total_mileage = 0;
 456   2              distance = 0;
 457   2              fun_info_save(); // å°†ä¿¡æ¯å†™å›flash
 458   2      #if USE_MY_DEBUG
 459   2              printf(" flag_clear_total_mileage \n");
 460   2      #endif
 461   2          }
 462   1      
 463   1          if (flag_clear_sub_total_mileage)
 464   1          {
 465   2              // å¦‚æœè¦æ¸…é™¤å°è®¡é‡Œç¨‹
 466   2              flag_clear_sub_total_mileage = 0;
C51 COMPILER V9.60.7.0   INSTRUCTION                                                       11/20/2024 15:14:14 PAGE 9   

 467   2              fun_info.save_info.subtotal_mileage = 0;
 468   2              distance = 0;
 469   2              fun_info_save(); // å°†ä¿¡æ¯å†™å›flash
 470   2      #if USE_MY_DEBUG
 471   2              printf(" flag_clear_sub_total_mileage \n");
 472   2      #endif
 473   2          }
 474   1      }

C51 COMPILATION COMPLETE.  0 WARNING(S),  1 ERROR(S)
